<?xml version="1.0"?>
<launch>
    <!-- ============================ SETTINGS ============================= -->

    <!-- Node frequency: the frequency [Hz] which rate.sleep() function will
    attempt to maintain in the main_loop. -->
    <arg 
    name="node_frequency" 
    default="500"/>

    <!-- Output folder path: the absolute path to the main data folder (no slash
    at the end). The standard file stucture will be generated in this folder:
    
    experiment (output_folder_path):
    |_____p0 (folder):
    |   |
    |   |_____m0 (folder):
    |   |   |
    |   |   |_____t0 (folder):
    |   |   |_____t1 (folder):
    |   |   |_____...
    |   |   
    |   |_____m1 (folder):
    |   |   |_____t0 (folder):
    |   |   |_____t1 (folder):
    |   |   |_____...
    |   |   
    |   |_____...
    |
    |_____p1 (folder):
    |   |
    |   |_____...
    |
    |_____...

     -->
    <arg
    name="output_folder_path" 
    default="/home/fetch/data"/>

    <!-- Output file name: the file name in the following format:
    "experiment-name_p0_m0_t0.csv" (no slashes). Experiment-name should be
    separated with dashes. -->
    <arg
    name="output_file_name" 
    default=""/>

    <!-- Data recording period: time in seconds between data storing. -->
    <arg 
    name="data_recording_period" 
    default="0.5"/>

    <!-- File writing period: time in seconds between file writings. -->
    <arg 
    name="file_writing_period" 
    default="10"/>

    <!-- Topics Specifiers Columns: specifies which data topics are recordered.
    Format (a separate line for each entry, whitespaces between, a dot "." in
    front of the message_specifier): 
    "/topic_name .message_specifier csv_column_name"

    /topic_name: is the topic name. 
    .message_specifier: specifies which field within the topic message should be
    recorded. If no message_specifier is required, place a single dot.
    csv_column_name - the column name in the output .csv file, where the data
    will be stored. 
    
    Example: 
    default="
    /right/controller_feedback/joystick . right_joystick
    /right/controller_feedback/joystick .button right_joystick_button
    "/>  
 
    -->
    <arg 
    name="topics_specifiers_columns" 
    default="

    /mode .data mode

    /task_manager/target_counter .data target_number
    /task_manager/target_identifier .id target_id
    /task_manager/target_identifier .name target_name
    /task_manager/target_identifier .expiration target_expiration
    
    /my_gen3/robot_control/current_task_state .data task_state

    /object_tracker/error_code .data error_code
    /object_tracker/restocking .data restocking
    /remote_interface/buttons .data button_pressed

    /update_bounds/failure_id .data failure_id
    /update_bounds/failure_start_time .data failure_start_time
    /update_bounds/failure_end_time .data failure_end_time
    /update_bounds/failure_state .data failure_state
    /update_bounds/failure_durations .data failure_durations
    /update_bounds/success .data is_success

    /update_bounds/operator_failure_times .data[0] 1_total_time_failure
    /update_bounds/operator_failure_times .data[1] 2_total_time_failure

    /update_bounds/assigned_to .data assigned_to

    /update_bounds/task_requirements .data[0] requirement_1
    /update_bounds/task_requirements .data[1] requirement_2
    /update_bounds/task_requirements .data[2] requirement_3

    /update_bounds/threshold .data threshold
    /update_bounds/learning_rate .data learning_rate
    /update_bounds/weight_decay .data weight_decay

    /update_bounds/adjusted_threshold .data adjusted_threshold

    /update_bounds/remote_no_sigmoid_bounds .data remote_no_sigmoid_bounds
    /update_bounds/local_no_sigmoid_bounds .data local_no_sigmoid_bounds

    /update_bounds/remote_bound_1 .data[0] remote_lower_bound_1
    /update_bounds/remote_bound_1 .data[1] remote_upper_bound_1
    /update_bounds/local_bound_1 .data[0] local_lower_bound_1
    /update_bounds/local_bound_1 .data[1] local_upper_bound_1
    /update_bounds/remote_bound_2 .data[0] remote_lower_bound_2
    /update_bounds/remote_bound_2 .data[1] remote_upper_bound_2
    /update_bounds/local_bound_2 .data[0] local_lower_bound_2
    /update_bounds/local_bound_2 .data[1] local_upper_bound_2
    /update_bounds/remote_bound_3 .data[0] remote_lower_bound_3
    /update_bounds/remote_bound_3 .data[1] remote_upper_bound_3
    /update_bounds/local_bound_3 .data[0] local_lower_bound_3
    /update_bounds/local_bound_3 .data[1] local_upper_bound_3

    /my_gen3/joint_states .position[0] joint_0_position
    /my_gen3/joint_states .position[1] joint_1_position
    /my_gen3/joint_states .position[2] joint_2_position
    /my_gen3/joint_states .position[3] joint_3_position
    /my_gen3/joint_states .position[4] joint_4_position
    /my_gen3/joint_states .position[5] joint_5_position
    /my_gen3/joint_states .position[6] joint_6_position

    /chest_logger/current_position .data chest_position

    /my_gen3/base_feedback .actuators[0].fault_bank_a joint_error

    /my_gen3/relaxed_ik/commanded_pose_gcs .position.x commanded_pose_gcs_x
    /my_gen3/relaxed_ik/commanded_pose_gcs .position.y commanded_pose_gcs_y
    /my_gen3/relaxed_ik/commanded_pose_gcs .position.z commanded_pose_gcs_z
    
    /my_gen3/relaxed_ik/joint_angle_solutions .joint_angles relaxed_ik_angles_solution
    
    /my_gen3/positional_control/input_pose .position.x input_pose_x
    /my_gen3/positional_control/input_pose .position.y input_pose_y
    /my_gen3/positional_control/input_pose .position.z input_pose_z

    /my_gen3/gripper_control/force_grasping_status .data grasping

    /my_gen3/target_hologram .position.x anchor_to_target_x
    /my_gen3/target_hologram .position.y anchor_to_target_y
    /my_gen3/target_hologram .position.z anchor_to_target_z

    /my_gen3/tf_chest_cam_anchor .position.x anchor_to_camera_x
    /my_gen3/tf_chest_cam_anchor .position.y anchor_to_camera_y
    /my_gen3/tf_chest_cam_anchor .position.z anchor_to_camera_z
    
    /my_gen3/tf_base_tool_frame .position.x base_to_tool_frame_x
    /my_gen3/tf_base_tool_frame .position.y base_to_tool_frame_y
    /my_gen3/tf_base_tool_frame .position.z base_to_tool_frame_z

    /my_gen3/target_workspace_cam .x camera_to_target_x
    /my_gen3/target_workspace_cam .y camera_to_target_y
    /my_gen3/target_workspace_cam .z camera_to_target_z

    /my_gen3/tf_base_target_cam  .position.x base_to_target_x
    /my_gen3/tf_base_target_cam  .position.y base_to_target_y
    /my_gen3/tf_base_target_cam  .position.z base_to_target_z

    /workspace_cam/target_position_in_frame .data[0] target_position_fov_x
    /workspace_cam/target_position_in_frame .data[1] target_position_fov_y
    "/>
    <!-- default="$(find data_collector)/topics_specifiers_columns.yaml"/> -->

    <!-- ======================== END OF SETTINGS ========================== -->
    
    <!-- Data writer: -->     
    <node 
    pkg="data_collector" 
    type="data_writer.py"
    name="data_writer" 
    output="screen">
        <param 
        name="node_frequency" 
        value="$(arg node_frequency)"/>
        <param 
        name="output_folder_path" 
        value="$(arg output_folder_path)"/>
        <param 
        name="output_file_name" 
        value="$(arg output_file_name)"/>
        <param 
        name="data_recording_period" 
        value="$(arg data_recording_period)"/>
        <param 
        name="file_writing_period" 
        value="$(arg file_writing_period)"/>
        <param 
        name="topics_specifiers_columns" 
        value="$(arg topics_specifiers_columns)"/>
    </node>     
</launch>